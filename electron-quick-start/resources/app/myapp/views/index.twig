<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>WebTorrent video player</title>
    <style>
        #output video {
            width: 100%;
        }
        #progressBar {
            height: 5px;
            width: 0%;
            background-color: #35b44f;
            transition: width .4s ease-in-out;
        }
        body.is-seed .show-seed {
            display: inline;
        }
        body.is-seed .show-leech {
            display: none;
        }
        .show-seed {
            display: none;
        }
        #status code {
            font-size: 90%;
            font-weight: 700;
            margin-left: 3px;
            margin-right: 3px;
            border-bottom: 1px dashed rgba(255,255,255,0.3);
        }

        .is-seed #hero {
            background-color: #154820;
            transition: .5s .5s background-color ease-in-out;
        }
        #hero {
            background-color: #2a3749;
        }
        #status {
            color: #fff;
            font-size: 17px;
            padding: 5px;
        }
        a:link, a:visited {
            color: #30a247;
            text-decoration: none;
        }
    </style>

</head>
<body>
<input type="text" id="path" value="C:\Users\02300bd\Downloads"/>
<input type="text" placeholder="your magnet" id="magnet">
<input type="button" id="dl" value="download">
<div id="hero">
    <div id="output">
        <div id="progressBar"></div>
        <!-- The video player will be added here -->
    </div>
    <!-- Statistics -->
    <div id="status">
        <div>
            <span class="show-leech">Downloading </span>
            <span class="show-seed">Seeding </span>
            <code>
                <!-- Informative link to the torrent file -->
                <a id="torrentLink" href="C:\Users\02300bd\Downloads\sintel.torrent">sintel.torrent</a>
            </code>
            <span class="show-leech"> from </span>
            <span class="show-seed"> to </span>
            <code id="numPeers">0 peers</code>.
        </div>
        <div>
            <code id="downloaded"></code>
            of <code id="total"></code>
            â€” <span id="remaining"></span><br/>
            &#x2198;<code id="downloadSpeed">0 b/s</code>
            / &#x2197;<code id="uploadSpeed">0 b/s</code>
        </div>
    </div>
</div>
<div id="torrents">

</div>
<script>if (typeof module === 'object') {window.module = module; module = undefined;}</script>
<script
        src="https://code.jquery.com/jquery-3.4.1.js"
        integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU="
        crossorigin="anonymous"></script>
<!-- Include the latest version of WebTorrent -->
<script src="https://cdn.jsdelivr.net/webtorrent/latest/webtorrent.min.js"></script>

<!-- Moment is used to show a human-readable remaining time -->
<script src="http://momentjs.com/downloads/moment.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.2.0/socket.io.js"></script>
<script>
    $('#dl').on('click', function () {


        var $body = document.body
        var $progressBar = document.querySelector('#progressBar')
        var $numPeers = document.querySelector('#numPeers')
        var $downloaded = document.querySelector('#downloaded')
        var $total = document.querySelector('#total')
        var $remaining = document.querySelector('#remaining')
        var $uploadSpeed = document.querySelector('#uploadSpeed')
        var $downloadSpeed = document.querySelector('#downloadSpeed')



        var socket = io();
        var data = {
                id: $('#magnet').val(),
                path: $('#path').val()
            };
        socket.emit('test', data);
        socket.on('progress', function (msg) {
            $numPeers.innerHTML = msg.peers;
            $progressBar.style.width = msg.percent + '%';
            $downloaded.innerHTML = msg.downloaded;
            $total.innerHTML = msg.total;
            $downloadSpeed.innerHTML = msg.dlspeed
            $uploadSpeed.innerHTML = msg.upspeed
            $remaining.innerHTML = msg.remaining
        })

        socket.on('finish', function (msg) {
            $body.className += ' is-seed'
            $remaining.innerHTML = 'done'
        })
    })
</script>
<script>if (window.module) module = window.module;</script>
</body>
</html>